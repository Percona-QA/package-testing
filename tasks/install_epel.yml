# Install EPEL and required GPG
#
- name: setup epel 7 repo
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version == "7"
  yum: name=https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm state=present

- name: install GPG key for epel 8
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version == "8"
  rpm_key:
    state: present
    key: https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-8

- name: install GPG key for Percona repos
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version >= "8"
  rpm_key:
    state: present
    key: https://repo.percona.com/yum/RPM-GPG-KEY-Percona

- name: setup epel 8 repo
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version == "8"
  yum: name=https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm state=present

- name: install GPG key for epel 9
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version == "9"
  rpm_key:
    state: present
    key: https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-9

- name: setup epel 9 repo
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version == "9"
  yum: name=https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm state=present
